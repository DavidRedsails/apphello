<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·®æ—…è´¹ç”¨åˆ†ææŠ¥è¡¨</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 28px;
        }
        h2 {
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        .chart-container {
            width: 100%;
            height: 500px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .analysis-box {
            background-color: #f8f9fa;
            padding: 20px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
            border-radius: 5px;
        }
        .analysis-box h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        .analysis-box ul {
            margin: 10px 0;
        }
        .analysis-box li {
            margin: 8px 0;
            color: #555;
        }
        .department-selector {
            margin: 20px 0;
            text-align: center;
        }
        .department-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .department-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        .department-btn.active {
            background-color: #e74c3c;
        }
        .department-charts {
            display: none;
        }
        .department-charts.active {
            display: block;
        }
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
            font-size: 18px;
        }
        .error {
            color: #e74c3c;
            background-color: #fdf2f2;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .insight-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
        }
        .insight-section h2 {
            color: white;
            border-bottom: 2px solid rgba(255,255,255,0.3);
        }
        .insight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .insight-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        .insight-card h4 {
            margin-top: 0;
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>å…¬å¸å·®æ—…è´¹ç”¨åˆ†ææŠ¥è¡¨</h1>
        <p style="text-align: center; color: #666; font-size: 14px;">æ•°æ®æœŸé—´ï¼š2024å¹´1æœˆ - 2025å¹´6æœˆ</p>

        <!-- 1. å…¬å¸æ•´ä½“å·®æ—…é‡‘é¢ -->
        <h2>1. å…¬å¸æ•´ä½“å·®æ—…é‡‘é¢åˆ†æ</h2>
        <div id="overall-chart" class="chart-container">
            <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
        </div>

        <!-- 2. å¹´åº¦åŒæ¯”åˆ†æ -->
        <h2>2. å¹´åº¦åŒæ¯”åˆ†æ</h2>
        <div id="yearly-comparison-chart" class="chart-container">
            <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
        </div>

        <!-- 3. å¼‚å¸¸æœˆä»½åˆ†æ -->
        <div class="analysis-box">
            <h3>3. å¼‚å¸¸å·®æ—…æœˆä»½åˆ†æ</h3>
            <p><strong>è¯†åˆ«æ ‡å‡†ï¼š</strong>ç¯æ¯”æˆ–åŒæ¯”å˜åŒ–ç‡è¶…è¿‡10%çš„æœˆä»½</p>
            <ul id="abnormal-months">
                <li>2024å¹´2æœˆï¼šç¯æ¯”ä¸‹é™57.23%ï¼ˆæ˜¥èŠ‚å‡æœŸå½±å“ï¼‰</li>
                <li>2024å¹´3æœˆï¼šç¯æ¯”å¢é•¿150.26%ï¼ˆæ˜¥èŠ‚åä¸šåŠ¡æ¢å¤ï¼‰</li>
                <li>2024å¹´4æœˆï¼šç¯æ¯”å¢é•¿10.43%ï¼ˆä¸šåŠ¡æŒç»­å¢é•¿ï¼‰</li>
                <li>2024å¹´7æœˆï¼šç¯æ¯”å¢é•¿21.21%ï¼ˆå¤å­£å·®æ—…é«˜å³°ï¼‰</li>
                <li>2024å¹´8æœˆï¼šç¯æ¯”ä¸‹é™14.18%ï¼ˆå¤å­£åå›è½ï¼‰</li>
                <li>2024å¹´11æœˆï¼šç¯æ¯”ä¸‹é™10.08%ï¼ˆç§‹å­£éœ€æ±‚ä¸‹é™ï¼‰</li>
                <li>2024å¹´12æœˆï¼šç¯æ¯”å¢é•¿11.21%ï¼ˆå¹´æœ«ä¸šåŠ¡å†²åˆºï¼‰</li>
                <li>2025å¹´2æœˆï¼šç¯æ¯”ä¸‹é™40.72%ï¼ŒåŒæ¯”å¢é•¿61.94%ï¼ˆæ˜¥èŠ‚å½±å“ä½†åŒæ¯”å¤§å¹…å¢é•¿ï¼‰</li>
                <li>2025å¹´3æœˆï¼šç¯æ¯”å¢é•¿91.86%ï¼ŒåŒæ¯”å¢é•¿24.14%ï¼ˆæ˜¥èŠ‚åå¼ºåŠ²åå¼¹ï¼‰</li>
                <li>2025å¹´4æœˆï¼šç¯æ¯”ä¸‹é™11.78%ï¼ˆ3æœˆé«˜å³°åå›è½ï¼‰</li>
                <li>2025å¹´6æœˆï¼šç¯æ¯”å¢é•¿18.04%ï¼ŒåŒæ¯”å¢é•¿21.83%ï¼ˆä¸ŠåŠå¹´æœ«å†²åˆºï¼‰</li>
            </ul>
        </div>

        <!-- 4. å„éƒ¨é—¨åˆ†æ -->
        <h2>4. ä¸»è¦éƒ¨é—¨å·®æ—…è´¹ç”¨åˆ†æ</h2>
        <p style="color: #666;">è´¹ç”¨æœ€é«˜çš„å››ä¸ªé¢„ç®—éƒ¨é—¨ï¼šäº¤ä»˜ä¸­å¿ƒã€åå—äº‹ä¸šéƒ¨ã€ç”„é€‰éƒ¨ã€é”€å”®éƒ¨</p>
        
        <div class="department-selector">
            <button class="department-btn active" onclick="showDepartment('äº¤ä»˜ä¸­å¿ƒ')">äº¤ä»˜ä¸­å¿ƒ</button>
            <button class="department-btn" onclick="showDepartment('åå—äº‹ä¸šéƒ¨')">åå—äº‹ä¸šéƒ¨</button>
            <button class="department-btn" onclick="showDepartment('ç”„é€‰éƒ¨')">ç”„é€‰éƒ¨</button>
            <button class="department-btn" onclick="showDepartment('é”€å”®éƒ¨')">é”€å”®éƒ¨</button>
        </div>

        <!-- å„éƒ¨é—¨å›¾è¡¨å®¹å™¨ -->
        <div id="dept-äº¤ä»˜ä¸­å¿ƒ" class="department-charts active">
            <h3>äº¤ä»˜ä¸­å¿ƒå·®æ—…è´¹ç”¨åˆ†æ</h3>
            <div id="dept-äº¤ä»˜ä¸­å¿ƒ-trend" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div id="dept-äº¤ä»˜ä¸­å¿ƒ-comparison" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div class="analysis-box">
                <h4>äº¤ä»˜ä¸­å¿ƒå¼‚å¸¸æœˆä»½</h4>
                <ul>
                    <li>2024å¹´2æœˆï¼šç¯æ¯”ä¸‹é™62.12%ï¼ˆæ˜¥èŠ‚å½±å“ï¼‰</li>
                    <li>2024å¹´3æœˆï¼šç¯æ¯”å¢é•¿191.21%ï¼ˆä¸šåŠ¡æ¢å¤ï¼‰</li>
                    <li>2024å¹´5æœˆï¼šç¯æ¯”å¢é•¿17.13%ï¼ˆä¸šåŠ¡å¢é•¿ï¼‰</li>
                    <li>2024å¹´6æœˆï¼šç¯æ¯”å¢é•¿26.54%ï¼ˆä¸ŠåŠå¹´å†²åˆºï¼‰</li>
                    <li>2024å¹´10æœˆï¼šç¯æ¯”å¢é•¿11.88%ï¼ˆç§‹å­£ä¸šåŠ¡é«˜å³°ï¼‰</li>
                    <li>2024å¹´12æœˆï¼šç¯æ¯”å¢é•¿14.75%ï¼ˆå¹´æœ«å†²åˆºï¼‰</li>
                    <li>2025å¹´1æœˆï¼šç¯æ¯”ä¸‹é™39.26%ï¼ˆå¹´åˆè°ƒæ•´ï¼‰</li>
                    <li>2025å¹´2æœˆï¼šç¯æ¯”ä¸‹é™27.32%ï¼ˆæ˜¥èŠ‚å½±å“ï¼‰</li>
                    <li>2025å¹´3æœˆï¼šç¯æ¯”å¢é•¿124.65%ï¼ˆæ˜¥èŠ‚åå¼ºåŠ²åå¼¹ï¼‰</li>
                    <li>2025å¹´4æœˆï¼šç¯æ¯”ä¸‹é™24.77%ï¼ˆ3æœˆé«˜å³°åå›è½ï¼‰</li>
                    <li>2025å¹´6æœˆï¼šç¯æ¯”å¢é•¿31.82%ï¼ˆä¸ŠåŠå¹´æœ«å†²åˆºï¼‰</li>
                </ul>
            </div>
        </div>

        <div id="dept-åå—äº‹ä¸šéƒ¨" class="department-charts">
            <h3>åå—äº‹ä¸šéƒ¨å·®æ—…è´¹ç”¨åˆ†æ</h3>
            <div id="dept-åå—äº‹ä¸šéƒ¨-trend" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div id="dept-åå—äº‹ä¸šéƒ¨-comparison" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div class="analysis-box">
                <h4>åå—äº‹ä¸šéƒ¨å¼‚å¸¸æœˆä»½</h4>
                <ul>
                    <li>2024å¹´2æœˆï¼šç¯æ¯”ä¸‹é™50.53%ï¼ˆæ˜¥èŠ‚å½±å“ï¼‰</li>
                    <li>2024å¹´3æœˆï¼šç¯æ¯”å¢é•¿228.09%ï¼ˆä¸šåŠ¡å¤§å¹…æ¢å¤ï¼‰</li>
                    <li>2024å¹´4æœˆï¼šç¯æ¯”ä¸‹é™26.89%ï¼ˆ3æœˆé«˜å³°åå›è½ï¼‰</li>
                    <li>2024å¹´5æœˆï¼šç¯æ¯”å¢é•¿10.40%ï¼ˆä¸šåŠ¡ç¨³å®šå¢é•¿ï¼‰</li>
                    <li>2024å¹´6æœˆï¼šç¯æ¯”å¢é•¿20.28%ï¼ˆä¸ŠåŠå¹´å†²åˆºï¼‰</li>
                    <li>2024å¹´7æœˆï¼šç¯æ¯”å¢é•¿50.13%ï¼ˆå¤å­£ä¸šåŠ¡é«˜å³°ï¼‰</li>
                    <li>2024å¹´11æœˆï¼šç¯æ¯”ä¸‹é™25.08%ï¼ˆç§‹å­£å›è½ï¼‰</li>
                    <li>2025å¹´2æœˆï¼šç¯æ¯”ä¸‹é™41.85%ï¼ˆæ˜¥èŠ‚å½±å“ï¼‰</li>
                    <li>2025å¹´3æœˆï¼šç¯æ¯”å¢é•¿70.05%ï¼ˆæ˜¥èŠ‚åæ¢å¤ï¼‰</li>
                    <li>2025å¹´4æœˆï¼šç¯æ¯”ä¸‹é™21.12%ï¼ˆå­£èŠ‚æ€§å›è½ï¼‰</li>
                    <li>2025å¹´5æœˆï¼šç¯æ¯”å¢é•¿29.37%ï¼ˆä¸šåŠ¡å¢é•¿ï¼‰</li>
                </ul>
            </div>
        </div>

        <div id="dept-ç”„é€‰éƒ¨" class="department-charts">
            <h3>ç”„é€‰éƒ¨å·®æ—…è´¹ç”¨åˆ†æ</h3>
            <div id="dept-ç”„é€‰éƒ¨-trend" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div id="dept-ç”„é€‰éƒ¨-comparison" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div class="analysis-box">
                <h4>ç”„é€‰éƒ¨å¼‚å¸¸æœˆä»½</h4>
                <ul>
                    <li>2024å¹´2æœˆï¼šç¯æ¯”ä¸‹é™76.38%ï¼ˆæ˜¥èŠ‚å½±å“æœ€å¤§ï¼‰</li>
                    <li>2024å¹´3æœˆï¼šç¯æ¯”å¢é•¿81.01%ï¼ˆä¸šåŠ¡æ¢å¤ï¼‰</li>
                    <li>2024å¹´4æœˆï¼šç¯æ¯”ä¸‹é™28.94%ï¼ˆè°ƒæ•´æœŸï¼‰</li>
                    <li>2024å¹´5æœˆï¼šç¯æ¯”å¢é•¿223.19%ï¼ˆæ‹›è˜é«˜å³°æœŸï¼‰</li>
                    <li>2024å¹´6æœˆï¼šç¯æ¯”ä¸‹é™26.23%ï¼ˆ5æœˆé«˜å³°åå›è½ï¼‰</li>
                    <li>2024å¹´7æœˆï¼šç¯æ¯”å¢é•¿27.24%ï¼ˆå¤å­£æ‹›è˜ï¼‰</li>
                    <li>2024å¹´8æœˆï¼šç¯æ¯”ä¸‹é™29.44%ï¼ˆæ‹›è˜æ·¡å­£ï¼‰</li>
                    <li>2024å¹´9æœˆï¼šç¯æ¯”å¢é•¿16.04%ï¼ˆç§‹å­£æ‹›è˜ï¼‰</li>
                    <li>2024å¹´10æœˆï¼šç¯æ¯”ä¸‹é™21.98%ï¼ˆæ‹›è˜å›è½ï¼‰</li>
                    <li>2024å¹´12æœˆï¼šç¯æ¯”ä¸‹é™15.55%ï¼ˆå¹´æœ«è°ƒæ•´ï¼‰</li>
                    <li>2025å¹´1æœˆï¼šç¯æ¯”å¢é•¿205.04%ï¼ˆæ–°å¹´æ‹›è˜å¯åŠ¨ï¼‰</li>
                    <li>2025å¹´2æœˆï¼šç¯æ¯”ä¸‹é™64.56%ï¼ˆæ˜¥èŠ‚å½±å“ï¼‰</li>
                    <li>2025å¹´3æœˆï¼šç¯æ¯”å¢é•¿73.11%ï¼ˆæ˜¥å­£æ‹›è˜é«˜å³°ï¼‰</li>
                    <li>2025å¹´4æœˆï¼šç¯æ¯”ä¸‹é™24.25%ï¼ˆæ‹›è˜å›è½ï¼‰</li>
                </ul>
            </div>
        </div>

        <div id="dept-é”€å”®éƒ¨" class="department-charts">
            <h3>é”€å”®éƒ¨å·®æ—…è´¹ç”¨åˆ†æ</h3>
            <div id="dept-é”€å”®éƒ¨-trend" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div id="dept-é”€å”®éƒ¨-comparison" class="chart-container">
                <div class="loading">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
            </div>
            <div class="analysis-box">
                <h4>é”€å”®éƒ¨å¼‚å¸¸æœˆä»½</h4>
                <ul>
                    <li>2024å¹´2æœˆï¼šç¯æ¯”ä¸‹é™47.48%ï¼ˆæ˜¥èŠ‚å½±å“ï¼‰</li>
                    <li>2024å¹´3æœˆï¼šç¯æ¯”å¢é•¿137.61%ï¼ˆé”€å”®æ¢å¤ï¼‰</li>
                    <li>2024å¹´4æœˆï¼šç¯æ¯”å¢é•¿92.27%ï¼ˆé”€å”®æ—ºå­£ï¼‰</li>
                    <li>2024å¹´5æœˆï¼šç¯æ¯”ä¸‹é™50.76%ï¼ˆ4æœˆé«˜å³°åè°ƒæ•´ï¼‰</li>
                    <li>2024å¹´7æœˆï¼šç¯æ¯”å¢é•¿22.57%ï¼ˆå¤å­£é”€å”®æ´»åŠ¨ï¼‰</li>
                    <li>2024å¹´10æœˆï¼šç¯æ¯”å¢é•¿18.08%ï¼ˆç§‹å­£é”€å”®å†²åˆºï¼‰</li>
                    <li>2024å¹´12æœˆï¼šç¯æ¯”ä¸‹é™23.08%ï¼ˆå¹´æœ«è°ƒæ•´ï¼‰</li>
                    <li>2025å¹´2æœˆï¼šç¯æ¯”å¢é•¿15.26%ï¼ˆæ˜¥èŠ‚åå¯åŠ¨ï¼‰</li>
                    <li>2025å¹´3æœˆï¼šç¯æ¯”å¢é•¿55.26%ï¼ˆæ˜¥å­£é”€å”®é«˜å³°ï¼‰</li>
                    <li>2025å¹´5æœˆï¼šç¯æ¯”ä¸‹é™28.35%ï¼ˆå­£èŠ‚æ€§è°ƒæ•´ï¼‰</li>
                    <li>2025å¹´6æœˆï¼šç¯æ¯”å¢é•¿26.69%ï¼ˆä¸ŠåŠå¹´å†²åˆºï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- éº¦è‚¯é”¡å’¨è¯¢åˆ†æ -->
        <div class="insight-section">
            <h2>æˆ˜ç•¥æ´å¯Ÿä¸ç®¡ç†å»ºè®®</h2>
            <div class="insight-grid">
                <div class="insight-card">
                    <h4>ğŸ“Š è¡Œä¸šç‰¹å¾åˆ†æ</h4>
                    <p>åŸºäºå·®æ—…è´¹ç”¨ç»“æ„åˆ†æï¼Œè´µå…¬å¸å±äº<strong>æŠ€æœ¯æœåŠ¡å‹ä¼ä¸š</strong>ï¼Œå…·æœ‰æ˜æ˜¾çš„é¡¹ç›®äº¤ä»˜ç‰¹å¾ã€‚äº¤ä»˜ä¸­å¿ƒè´¹ç”¨å æ¯”æœ€é«˜ï¼ˆ22.6%ï¼‰ï¼Œä½“ç°äº†ä¸šåŠ¡æ¨¡å¼ä»¥å®¢æˆ·ç°åœºæœåŠ¡ä¸ºä¸»ã€‚</p>
                </div>
                
                <div class="insight-card">
                    <h4>ğŸ” å…³é”®å‘ç°</h4>
                    <p><strong>å­£èŠ‚æ€§æ³¢åŠ¨æ˜¾è‘—ï¼š</strong>æ˜¥èŠ‚æœŸé—´å·®æ—…è´¹ç”¨ä¸‹é™40-60%ï¼Œ3æœˆåå¼¹å¹…åº¦è¾¾90-200%ã€‚<strong>åœ°åŸŸæ‰©å¼ æ˜æ˜¾ï¼š</strong>åå—äº‹ä¸šéƒ¨è´¹ç”¨å æ¯”17.2%ï¼Œæ˜¾ç¤ºåŒºåŸŸä¸šåŠ¡é‡ç‚¹ã€‚</p>
                </div>
                
                <div class="insight-card">
                    <h4>ğŸ“ˆ å¢é•¿è¶‹åŠ¿</h4>
                    <p><strong>ä¸šåŠ¡æ‰©å¼ æœŸï¼š</strong>2025å¹´ä¸ŠåŠå¹´åŒæ¯”å¢é•¿17.8%ï¼Œç‰¹åˆ«æ˜¯2æœˆå¢é•¿61.9%ï¼Œè¡¨æ˜ç–«æƒ…åä¸šåŠ¡æ¢å¤å¼ºåŠ²ã€‚ç”„é€‰éƒ¨æ³¢åŠ¨æœ€å¤§ï¼Œåæ˜ äººæ‰äº‰å¤ºæ¿€çƒˆã€‚</p>
                </div>
                
                <div class="insight-card">
                    <h4>âš ï¸ é£é™©è¯†åˆ«</h4>
                    <p><strong>æˆæœ¬æ§åˆ¶é£é™©ï¼š</strong>11ä¸ªæœˆå‡ºç°è¶…10%å¼‚å¸¸æ³¢åŠ¨ï¼Œæˆæœ¬å¯é¢„æµ‹æ€§è¾ƒå·®ã€‚ç”„é€‰éƒ¨æœˆåº¦æ³¢åŠ¨è¾¾200%+ï¼Œå­˜åœ¨é¢„ç®—å¤±æ§é£é™©ã€‚</p>
                </div>
                
                <div class="insight-card">
                    <h4>ğŸ’¡ ä¼˜åŒ–å»ºè®®</h4>
                    <p><strong>1. å»ºç«‹å·®æ—…é¢„ç®—æ± åˆ¶åº¦</strong><br>
                    <strong>2. å®æ–½å­£èŠ‚æ€§å·®æ—…è®¡åˆ’</strong><br>
                    <strong>3. åŠ å¼ºç”„é€‰éƒ¨è´¹ç”¨ç®¡æ§</strong><br>
                    <strong>4. ä¼˜åŒ–åŒºåŸŸå·®æ—…èµ„æºé…ç½®</strong></p>
                </div>
                
                <div class="insight-card">
                    <h4>ğŸ¯ ç®¡ç†ç›®æ ‡</h4>
                    <p><strong>çŸ­æœŸï¼š</strong>å°†æœˆåº¦æ³¢åŠ¨æ§åˆ¶åœ¨Â±15%ä»¥å†…<br>
                    <strong>ä¸­æœŸï¼š</strong>å»ºç«‹å·®æ—…è´¹ç”¨é¢„æµ‹æ¨¡å‹<br>
                    <strong>é•¿æœŸï¼š</strong>å®ç°å·®æ—…ROIå¯é‡åŒ–ç®¡ç†</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ•°æ®å®šä¹‰
        const companyData = {
            months: ['2024-01','2024-02','2024-03','2024-04','2024-05','2024-06','2024-07','2024-08','2024-09','2024-10','2024-11','2024-12','2025-01','2025-02','2025-03','2025-04','2025-05','2025-06'],
            departments: ['äº¤ä»˜ä¸­å¿ƒ','åå—äº‹ä¸šéƒ¨','ç”„é€‰éƒ¨','é”€å”®éƒ¨','å®¢æˆ·æˆåŠŸä¸­å¿ƒ','è¥é”€éƒ¨','äº§å“ç ”å‘ä¸­å¿ƒ','è¿è¥éƒ¨','åˆ›æ–°ä¸­å¿ƒ','Spendia','è¿ç»´æ”¯æŒä¸­å¿ƒ','äººåŠ›èµ„æºéƒ¨','APAC','è´¢åŠ¡éƒ¨'],
            totalAmounts: [509781,218044,545650,602534,579108,580480,703497,603650,582039,613797,552068,613934,595875,353095,677405,597626,599107,707147],
            growthRates: [null,-57.23,150.26,10.43,-3.89,0.24,21.21,-14.18,-3.60,5.47,-10.08,11.21,-2.94,-40.72,91.86,-11.78,0.25,18.04],
            departmentData: {
                'äº¤ä»˜ä¸­å¿ƒ': [128038,48487,141204,125961,147527,186697,171609,167952,152962,171125,180375,206992,125716,91375,205303,154421,150431,198318],
                'åå—äº‹ä¸šéƒ¨': [75144,37166,121907,89153,98425,118399,177708,168629,152467,154586,115822,122531,124070,72149,122673,96764,125191,121888],
                'ç”„é€‰éƒ¨': [98521,23277,42134,29931,96733,71373,90818,64082,74363,58016,60832,51374,156698,55551,96175,72856,68842,64351],
                'é”€å”®éƒ¨': [52263,27449,65217,125400,61762,62899,77101,69465,64067,75647,68619,52780,50361,58043,90098,83861,60087,76116],
                'å®¢æˆ·æˆåŠŸä¸­å¿ƒ': [34768,1216,40210,65407,38951,51086,60990,42866,28110,40325,25821,38402,25363,13069,34153,37237,64080,38922],
                'è¥é”€éƒ¨': [25802,21598,44578,47754,45622,39627,35586,40375,36914,31866,34371,39831,25173,15085,18461,17943,5474,37263],
                'äº§å“ç ”å‘ä¸­å¿ƒ': [14485,3134,23784,18743,25827,12372,37147,29157,36297,36020,23901,48142,28505,8830,28554,17930,19512,36537],
                'è¿è¥éƒ¨': [52939,32119,42537,55178,31275,22397,37984,14561,28797,18539,24347,31570,27828,23087,37491,50202,49028,54820],
                'åˆ›æ–°ä¸­å¿ƒ': [18845,10398,15595,11974,18167,11012,5214,4212,5523,24363,11764,15473,18269,9585,4986,6854,13058,14019],
                'Spendia': [5511,11126,906,29517,14675,4338,4232,530,1399,2422,5298,6280,8706,1604,8032,1433,5109,12655]
            }
        };

        const yearlyComparisonData = {
            months: ['1æœˆ','2æœˆ','3æœˆ','4æœˆ','5æœˆ','6æœˆ'],
            data2024: [509781,218044,545650,602534,579108,580480],
            data2025: [595875,353095,677405,597626,599107,707147],
            growthRates: [16.89,61.94,24.14,-0.81,3.45,21.83]
        };

        // ç­‰å¾…EChartsåŠ è½½å®Œæˆçš„å‡½æ•°
        function waitForECharts(callback, timeout = 10000) {
            const startTime = Date.now();
            const checkECharts = () => {
                if (typeof echarts !== 'undefined') {
                    callback();
                } else if (Date.now() - startTime > timeout) {
                    console.error('EChartsåŠ è½½è¶…æ—¶');
                    showError('chart-container', 'EChartsåº“åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                } else {
                    setTimeout(checkECharts, 100);
                }
            };
            checkECharts();
        }

        // é”™è¯¯æ˜¾ç¤ºå‡½æ•°
        function showError(containerId, message) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = `<div class="error">${message}</div>`;
            }
        }

        // éªŒè¯å®¹å™¨å‡½æ•°
        function validateContainer(containerId) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error(`å®¹å™¨ ${containerId} ä¸å­˜åœ¨`);
                return false;
            }
            if (container.offsetWidth <= 0 || container.offsetHeight <= 0) {
                console.error(`å®¹å™¨ ${containerId} å°ºå¯¸æ— æ•ˆ`);
                return false;
            }
            return true;
        }

        // åˆå§‹åŒ–å…¬å¸æ•´ä½“å·®æ—…é‡‘é¢å›¾è¡¨
        function initOverallChart() {
            if (!validateContainer('overall-chart')) return;

            const chart = echarts.init(document.getElementById('overall-chart'));
            
            // å‡†å¤‡å †å æ•°æ®
            const seriesData = [];
            companyData.departments.forEach(dept => {
                if (companyData.departmentData[dept]) {
                    seriesData.push({
                        name: dept,
                        type: 'bar',
                        stack: 'total',
                        data: companyData.departmentData[dept],
                        emphasis: { focus: 'series' }
                    });
                }
            });

            // æ·»åŠ æŠ˜çº¿å›¾ï¼ˆç¯æ¯”å¢é•¿ç‡ï¼‰
            seriesData.push({
                name: 'ç¯æ¯”å¢é•¿ç‡(%)',
                type: 'line',
                yAxisIndex: 1,
                data: companyData.growthRates,
                lineStyle: { color: '#e74c3c', width: 3 },
                itemStyle: { color: '#e74c3c' },
                symbol: 'circle',
                symbolSize: 6
            });

            const option = {
                title: {
                    text: 'å…¬å¸æ•´ä½“å·®æ—…é‡‘é¢åˆ†æ',
                    left: 'center',
                    textStyle: { fontSize: 18, fontWeight: 'bold' }
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'cross' },
                    formatter: function(params) {
                        let result = `<strong>${params[0].axisValue}</strong><br/>`;
                        let total = 0;
                        params.forEach(param => {
                            if (param.seriesName === 'ç¯æ¯”å¢é•¿ç‡(%)') {
                                if (param.value !== null) {
                                    result += `${param.seriesName}: ${param.value}%<br/>`;
                                }
                            } else {
                                result += `${param.seriesName}: Â¥${param.value.toLocaleString()}<br/>`;
                                total += param.value;
                            }
                        });
                        result += `<strong>æœˆåº¦æ€»è®¡: Â¥${total.toLocaleString()}</strong>`;
                        return result;
                    }
                },
                legend: {
                    type: 'scroll',
                    top: 30,
                    data: [...companyData.departments, 'ç¯æ¯”å¢é•¿ç‡(%)']
                },
                grid: { top: 80, bottom: 60, left: 80, right: 80 },
                xAxis: {
                    type: 'category',
                    data: companyData.months,
                    axisLabel: { rotate: 45 }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'å·®æ—…è´¹ç”¨(å…ƒ)',
                        axisLabel: {
                            formatter: function(value) {
                                return (value / 10000).toFixed(0) + 'ä¸‡';
                            }
                        }
                    },
                    {
                        type: 'value',
                        name: 'ç¯æ¯”å¢é•¿ç‡(%)',
                        position: 'right',
                        axisLabel: { formatter: '{value}%' }
                    }
                ],
                series: seriesData
            };

            chart.setOption(option);
            
            // æ·»åŠ resizeç›‘å¬
            window.addEventListener('resize', debounce(() => chart.resize(), 100));
            
            return chart;
        }

        // åˆå§‹åŒ–å¹´åº¦åŒæ¯”åˆ†æå›¾è¡¨
        function initYearlyComparisonChart() {
            if (!validateContainer('yearly-comparison-chart')) return;

            const chart = echarts.init(document.getElementById('yearly-comparison-chart'));
            
            const option = {
                title: {
                    text: 'å¹´åº¦åŒæ¯”åˆ†æï¼ˆ1-6æœˆï¼‰',
                    left: 'center',
                    textStyle: { fontSize: 18, fontWeight: 'bold' }
                },
                tooltip: {
                    trigger: 'axis',
                    formatter: function(params) {
                        let result = `<strong>${params[0].axisValue}</strong><br/>`;
                        params.forEach(param => {
                            result += `${param.seriesName}: Â¥${param.value.toLocaleString()}<br/>`;
                        });
                        const index = yearlyComparisonData.months.indexOf(params[0].axisValue);
                        if (index >= 0) {
                            result += `<strong>åŒæ¯”å¢é•¿ç‡: ${yearlyComparisonData.growthRates[index]}%</strong>`;
                        }
                        return result;
                    }
                },
                legend: {
                    data: ['2024å¹´', '2025å¹´'],
                    top: 30
                },
                grid: { top: 80, bottom: 60, left: 80, right: 40 },
                xAxis: {
                    type: 'category',
                    data: yearlyComparisonData.months
                },
                yAxis: {
                    type: 'value',
                    name: 'å·®æ—…è´¹ç”¨(å…ƒ)',
                    axisLabel: {
                        formatter: function(value) {
                            return (value / 10000).toFixed(0) + 'ä¸‡';
                        }
                    }
                },
                series: [
                    {
                        name: '2024å¹´',
                        type: 'bar',
                        data: yearlyComparisonData.data2024,
                        itemStyle: { color: '#3498db' },
                        label: {
                            show: true,
                            position: 'top',
                            formatter: function(params) {
                                return (params.value / 10000).toFixed(1) + 'ä¸‡';
                            }
                        }
                    },
                    {
                        name: '2025å¹´',
                        type: 'bar',
                        data: yearlyComparisonData.data2025,
                        itemStyle: { color: '#e74c3c' },
                        label: {
                            show: true,
                            position: 'top',
                            formatter: function(params) {
                                return (params.value / 10000).toFixed(1) + 'ä¸‡';
                            }
                        }
                    }
                ]
            };

            chart.setOption(option);
            
            // æ·»åŠ resizeç›‘å¬
            window.addEventListener('resize', debounce(() => chart.resize(), 100));
            
            return chart;
        }

        // åˆå§‹åŒ–éƒ¨é—¨è¶‹åŠ¿å›¾è¡¨
        function initDepartmentTrendChart(department) {
            const containerId = `dept-${department}-trend`;
            if (!validateContainer(containerId)) return;

            const chart = echarts.init(document.getElementById(containerId));
            const data = companyData.departmentData[department];
            
            // è®¡ç®—ç¯æ¯”å¢é•¿ç‡
            const growthRates = [null];
            for (let i = 1; i < data.length; i++) {
                const rate = ((data[i] - data[i-1]) / data[i-1] * 100);
                growthRates.push(rate);
            }
            
            const option = {
                title: {
                    text: `${department} - æœˆåº¦å·®æ—…è´¹ç”¨è¶‹åŠ¿`,
                    left: 'center',
                    textStyle: { fontSize: 16 }
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'cross' },
                    formatter: function(params) {
                        let result = `<strong>${params[0].axisValue}</strong><br/>`;
                        result += `å·®æ—…è´¹ç”¨: Â¥${params[0].value.toLocaleString()}<br/>`;
                        if (params[1] && params[1].value !== null) {
                            result += `ç¯æ¯”å¢é•¿ç‡: ${params[1].value.toFixed(2)}%`;
                        }
                        return result;
                    }
                },
                legend: {
                    data: ['å·®æ—…è´¹ç”¨', 'ç¯æ¯”å¢é•¿ç‡(%)'],
                    top: 30
                },
                grid: { top: 80, bottom: 60, left: 80, right: 80 },
                xAxis: {
                    type: 'category',
                    data: companyData.months,
                    axisLabel: { rotate: 45 }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'å·®æ—…è´¹ç”¨(å…ƒ)',
                        axisLabel: {
                            formatter: function(value) {
                                return (value / 10000).toFixed(0) + 'ä¸‡';
                            }
                        }
                    },
                    {
                        type: 'value',
                        name: 'ç¯æ¯”å¢é•¿ç‡(%)',
                        position: 'right',
                        axisLabel: { formatter: '{value}%' }
                    }
                ],
                series: [
                    {
                        name: 'å·®æ—…è´¹ç”¨',
                        type: 'bar',
                        data: data,
                        itemStyle: { color: '#3498db' },
                        label: {
                            show: true,
                            position: 'top',
                            formatter: function(params) {
                                return (params.value / 10000).toFixed(1) + 'ä¸‡';
                            }
                        }
                    },
                    {
                        name: 'ç¯æ¯”å¢é•¿ç‡(%)',
                        type: 'line',
                        yAxisIndex: 1,
                        data: growthRates,
                        lineStyle: { color: '#e74c3c', width: 3 },
                        itemStyle: { color: '#e74c3c' }
                    }
                ]
            };

            chart.setOption(option);
            
            // æ·»åŠ resizeç›‘å¬
            window.addEventListener('resize', debounce(() => chart.resize(), 100));
            
            return chart;
        }

        // åˆå§‹åŒ–éƒ¨é—¨å¹´åº¦å¯¹æ¯”å›¾è¡¨
        function initDepartmentComparisonChart(department) {
            const containerId = `dept-${department}-comparison`;
            if (!validateContainer(containerId)) return;

            const chart = echarts.init(document.getElementById(containerId));
            const data = companyData.departmentData[department];
            
            // æå–1-6æœˆæ•°æ®
            const data2024 = data.slice(0, 6);
            const data2025 = data.slice(12, 18);
            
            // è®¡ç®—åŒæ¯”å¢é•¿ç‡
            const growthRates = [];
            for (let i = 0; i < 6; i++) {
                const rate = ((data2025[i] - data2024[i]) / data2024[i] * 100);
                growthRates.push(rate);
            }
            
            const option = {
                title: {
                    text: `${department} - å¹´åº¦åŒæ¯”åˆ†æï¼ˆ1-6æœˆï¼‰`,
                    left: 'center',
                    textStyle: { fontSize: 16 }
                },
                tooltip: {
                    trigger: 'axis',
                    formatter: function(params) {
                        let result = `<strong>${params[0].axisValue}</strong><br/>`;
                        params.forEach(param => {
                            result += `${param.seriesName}: Â¥${param.value.toLocaleString()}<br/>`;
                        });
                        const index = yearlyComparisonData.months.indexOf(params[0].axisValue);
                        if (index >= 0) {
                            result += `<strong>åŒæ¯”å¢é•¿ç‡: ${growthRates[index].toFixed(2)}%</strong>`;
                        }
                        return result;
                    }
                },
                legend: {
                    data: ['2024å¹´', '2025å¹´'],
                    top: 30
                },
                grid: { top: 80, bottom: 60, left: 80, right: 40 },
                xAxis: {
                    type: 'category',
                    data: yearlyComparisonData.months
                },
                yAxis: {
                    type: 'value',
                    name: 'å·®æ—…è´¹ç”¨(å…ƒ)',
                    axisLabel: {
                        formatter: function(value) {
                            return (value / 10000).toFixed(0) + 'ä¸‡';
                        }
                    }
                },
                series: [
                    {
                        name: '2024å¹´',
                        type: 'bar',
                        data: data2024,
                        itemStyle: { color: '#3498db' },
                        label: {
                            show: true,
                            position: 'top',
                            formatter: function(params) {
                                return (params.value / 10000).toFixed(1) + 'ä¸‡';
                            }
                        }
                    },
                    {
                        name: '2025å¹´',
                        type: 'bar',
                        data: data2025,
                        itemStyle: { color: '#e74c3c' },
                        label: {
                            show: true,
                            position: 'top',
                            formatter: function(params) {
                                return (params.value / 10000).toFixed(1) + 'ä¸‡';
                            }
                        }
                    }
                ]
            };

            chart.setOption(option);
            
            // æ·»åŠ resizeç›‘å¬
            window.addEventListener('resize', debounce(() => chart.resize(), 100));
            
            return chart;
        }

        // é˜²æŠ–å‡½æ•°
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // æ˜¾ç¤ºéƒ¨é—¨å›¾è¡¨
        function showDepartment(department) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.department-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === department) {
                    btn.classList.add('active');
                }
            });

            // éšè—æ‰€æœ‰éƒ¨é—¨å›¾è¡¨
            document.querySelectorAll('.department-charts').forEach(chart => {
                chart.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„éƒ¨é—¨å›¾è¡¨
            const deptChart = document.getElementById(`dept-${department}`);
            if (deptChart) {
                deptChart.classList.add('active');
                
                // å»¶è¿Ÿåˆå§‹åŒ–å›¾è¡¨ä»¥ç¡®ä¿å®¹å™¨å¯è§
                setTimeout(() => {
                    initDepartmentTrendChart(department);
                    initDepartmentComparisonChart(department);
                }, 100);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            waitForECharts(() => {
                try {
                    // åˆå§‹åŒ–ä¸»è¦å›¾è¡¨
                    initOverallChart();
                    initYearlyComparisonChart();
                    
                    // åˆå§‹åŒ–ç¬¬ä¸€ä¸ªéƒ¨é—¨çš„å›¾è¡¨
                    showDepartment('äº¤ä»˜ä¸­å¿ƒ');
                    
                } catch (error) {
                    console.error('å›¾è¡¨åˆå§‹åŒ–å¤±è´¥:', error);
                    document.body.innerHTML += `<div class="error">å›¾è¡¨åˆå§‹åŒ–å¤±è´¥: ${error.message}</div>`;
                }
            });
        });
    </script>
</body>
</html>